@page
@model FixHub.Web.Pages.Requests.NewModel
@{
    ViewData["Title"] = "Solicitar servicio";
}

<div class="row justify-content-center">
    <div class="col-lg-8">
        <h2 class="fixhub-section-title mb-1">Solicitar servicio</h2>
        <p class="text-muted mb-4">Describe tu necesidad y FixHub asigna un t√©cnico verificado.</p>

        @if (!string.IsNullOrEmpty(Model.ErrorMessage))
        {
            <div class="alert alert-danger alert-dismissible fade show">@Model.ErrorMessage<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button></div>
        }

        @* Cards de categor√≠as *@
        <div class="mb-4">
            <label class="form-label">Categor√≠a</label>
            <div class="row g-2 g-md-3">
                <div class="col-6 col-md-4">
                    <label class="fixhub-category-card w-100 text-center @(Model.Input.CategoryId == 1 ? "fixhub-category-card-selected" : "")">
                        <input type="radio" asp-for="Input.CategoryId" value="1" class="d-none" />
                        <span class="d-block fixhub-category-icon">üîß</span>
                        <span>Plomer√≠a</span>
                    </label>
                </div>
                <div class="col-6 col-md-4">
                    <label class="fixhub-category-card w-100 text-center @(Model.Input.CategoryId == 2 ? "fixhub-category-card-selected" : "")">
                        <input type="radio" asp-for="Input.CategoryId" value="2" class="d-none" />
                        <span class="d-block fixhub-category-icon">‚ö°</span>
                        <span>Electricidad</span>
                    </label>
                </div>
                <div class="col-6 col-md-4">
                    <label class="fixhub-category-card w-100 text-center @(Model.Input.CategoryId == 4 ? "fixhub-category-card-selected" : "")">
                        <input type="radio" asp-for="Input.CategoryId" value="4" class="d-none" />
                        <span class="d-block fixhub-category-icon">‚ùÑÔ∏è</span>
                        <span>Aire Acondicionado</span>
                    </label>
                </div>
                <div class="col-6 col-md-4">
                    <label class="fixhub-category-card w-100 text-center @(Model.Input.CategoryId == 5 ? "fixhub-category-card-selected" : "")">
                        <input type="radio" asp-for="Input.CategoryId" value="5" class="d-none" />
                        <span class="d-block fixhub-category-icon">üñåÔ∏è</span>
                        <span>Pintura</span>
                    </label>
                </div>
                <div class="col-6 col-md-4">
                    <label class="fixhub-category-card w-100 text-center @(Model.Input.CategoryId == 3 ? "fixhub-category-card-selected" : "")">
                        <input type="radio" asp-for="Input.CategoryId" value="3" class="d-none" />
                        <span class="d-block fixhub-category-icon">üõ†Ô∏è</span>
                        <span>Handyman</span>
                    </label>
                </div>
                <div class="col-6 col-md-4">
                    <label class="fixhub-category-card w-100 text-center @(Model.Input.CategoryId == 6 ? "fixhub-category-card-selected" : "")">
                        <input type="radio" asp-for="Input.CategoryId" value="6" class="d-none" />
                        <span class="d-block fixhub-category-icon">üîê</span>
                        <span>Cerrajer√≠a</span>
                    </label>
                </div>
            </div>
            <span asp-validation-for="Input.CategoryId" class="text-danger small"></span>
        </div>

        <div class="card shadow-sm">
            <div class="card-body">
                <form method="post">
                    <div class="mb-3">
                        <label asp-for="Input.Title" class="form-label">T√≠tulo</label>
                        <input asp-for="Input.Title" class="form-control" placeholder="Ej. Fuga de agua en cocina" />
                        <span asp-validation-for="Input.Title" class="text-danger"></span>
                    </div>
                    <div class="mb-3">
                        <label asp-for="Input.Description" class="form-label">Descripci√≥n</label>
                        <textarea asp-for="Input.Description" class="form-control" rows="4"
                                  placeholder="Describe el problema con el mayor detalle posible..."></textarea>
                        <span asp-validation-for="Input.Description" class="text-danger"></span>
                    </div>
                    <div class="mb-3">
                        <label asp-for="Input.AddressText" class="form-label">Direcci√≥n</label>
                        <input asp-for="Input.AddressText" class="form-control" placeholder="Calle, ciudad, referencias..." />
                        <span asp-validation-for="Input.AddressText" class="text-danger"></span>
                    </div>
                    <div class="row g-2 mb-4">
                        <div class="col-md-6">
                            <label asp-for="Input.BudgetMin" class="form-label">Presupuesto m√≠nimo ($)</label>
                            <input asp-for="Input.BudgetMin" class="form-control" type="number" step="0.01" min="0" placeholder="50" />
                        </div>
                        <div class="col-md-6">
                            <label asp-for="Input.BudgetMax" class="form-label">Presupuesto m√°ximo ($)</label>
                            <input asp-for="Input.BudgetMax" class="form-control" type="number" step="0.01" min="0" placeholder="200" />
                        </div>
                    </div>
                    <div class="d-flex gap-2 flex-wrap">
                        <button type="submit" class="btn btn-fixhub-primary btn-lg">Enviar solicitud</button>
                        <a asp-page="/Requests/My" class="btn btn-outline-secondary">Cancelar</a>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        document.querySelectorAll('.fixhub-category-card').forEach(function(card) {
            card.addEventListener('click', function() {
                document.querySelectorAll('.fixhub-category-card').forEach(function(c) { c.classList.remove('fixhub-category-card-selected'); });
                this.classList.add('fixhub-category-card-selected');
                var radio = this.querySelector('input[type="radio"]');
                if (radio) radio.checked = true;
            });
        });
    </script>
}
